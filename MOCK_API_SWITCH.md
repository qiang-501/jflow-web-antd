# Mock æ•°æ®ä¸ API åˆ‡æ¢é…ç½®æŒ‡å—

## åŠŸèƒ½è¯´æ˜

å‰ç«¯é¡¹ç›®ç°åœ¨æ”¯æŒåœ¨ Mock æ•°æ®å’ŒçœŸå® API ä¹‹é—´çµæ´»åˆ‡æ¢ï¼Œæ— éœ€ä¿®æ”¹ä»£ç å³å¯é€šè¿‡é…ç½®å®Œæˆåˆ‡æ¢ã€‚

## é…ç½®æ–¹å¼

### æ–¹æ³• 1: ä¿®æ”¹ç¯å¢ƒé…ç½®æ–‡ä»¶

#### å¼€å‘ç¯å¢ƒ (`environment.development.ts`)

```typescript
export const environment = {
  production: false,
  apiUrl: "http://localhost:4200/api",
  fakeBackend: true,
  enableDebugMode: true,
  isAdmin: true,
  // true: ä½¿ç”¨Mockæ•°æ®, false: ä½¿ç”¨çœŸå®API
  useMockData: true, // ğŸ‘ˆ ä¿®æ”¹è¿™é‡Œ
};
```

#### ç”Ÿäº§ç¯å¢ƒ (`environment.ts`)

```typescript
export const environment = {
  production: true,
  apiUrl: "/api",
  fakeBackend: false,
  enableDebugMode: false,
  isAdmin: false,
  useMockData: false, // ç”Ÿäº§ç¯å¢ƒå§‹ç»ˆä½¿ç”¨çœŸå®API
};
```

## ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1: ä½¿ç”¨ Mock æ•°æ®å¼€å‘ï¼ˆæ— éœ€åç«¯ï¼‰

**é…ç½®**:

```typescript
useMockData: true;
```

**ä¼˜ç‚¹**:

- âœ… æ— éœ€å¯åŠ¨åç«¯æœåŠ¡
- âœ… å¿«é€Ÿå¼€å‘å’Œè°ƒè¯•å‰ç«¯åŠŸèƒ½
- âœ… ä¸ä¾èµ–åç«¯è¿›åº¦
- âœ… ç¨³å®šçš„æµ‹è¯•æ•°æ®

**é€‚ç”¨äº**:

- å‰ç«¯ç‹¬ç«‹å¼€å‘
- UI/UX è°ƒè¯•
- å‰ç«¯åŠŸèƒ½æµ‹è¯•
- æ¼”ç¤ºç¯å¢ƒ

### åœºæ™¯ 2: è¿æ¥çœŸå®åç«¯ API

**é…ç½®**:

```typescript
useMockData: false;
```

**å‰ç½®æ¡ä»¶**:

1. åç«¯æœåŠ¡å·²å¯åŠ¨ (é»˜è®¤: http://localhost:3000)
2. å·²é…ç½® `proxy.conf.json` ä»£ç†

**ä»£ç†é…ç½®** (`proxy.conf.json`):

```json
{
  "/api": {
    "target": "http://localhost:3000",
    "secure": false,
    "changeOrigin": true
  }
}
```

**ä¼˜ç‚¹**:

- âœ… çœŸå®æ•°æ®éªŒè¯
- âœ… å®Œæ•´çš„åç«¯é›†æˆæµ‹è¯•
- âœ… æµ‹è¯•çœŸå®ä¸šåŠ¡é€»è¾‘
- âœ… å‘ç°é›†æˆé—®é¢˜

**é€‚ç”¨äº**:

- å‰åç«¯è”è°ƒ
- é›†æˆæµ‹è¯•
- æ€§èƒ½æµ‹è¯•
- é¢„ç”Ÿäº§éªŒè¯

## å¿«é€Ÿåˆ‡æ¢æ­¥éª¤

### ä» Mock åˆ‡æ¢åˆ° API

1. å¯åŠ¨åç«¯æœåŠ¡

```bash
cd server
npm run start:dev
```

2. ä¿®æ”¹ `environment.development.ts`

```typescript
useMockData: false; // æ”¹ä¸º false
```

3. é‡å¯å‰ç«¯ï¼ˆè‡ªåŠ¨ä»£ç†åˆ°åç«¯ï¼‰

```bash
ng serve
```

### ä» API åˆ‡æ¢å› Mock

1. ä¿®æ”¹ `environment.development.ts`

```typescript
useMockData: true; // æ”¹ä¸º true
```

2. é‡å¯å‰ç«¯å³å¯ï¼ˆæ— éœ€åç«¯è¿è¡Œï¼‰

## å·¥ä½œåŸç†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Angular HTTP Interceptor Chain             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  FakeBackendInterceptor   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
          æ£€æŸ¥ environment.useMockData
                        â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“                               â†“
  useMockData: true            useMockData: false
        â†“                               â†“
  è¿”å› Mock æ•°æ®                   ä¼ é€’ç»™ next(req)
  (fake-backend.interceptor)              â†“
        â†“                          é€šè¿‡ proxy.conf.json
  å»¶è¿Ÿ 500ms æ¨¡æ‹Ÿç½‘ç»œ                      â†“
        â†“                          åç«¯ API (localhost:3000)
   è¿”å›å“åº”                                â†“
                                      è¿”å›çœŸå®æ•°æ®
```

## Mock æ•°æ®è¯´æ˜

Mock æ•°æ®ä½ç½®: `src/assets/data/`

åŒ…å«ä»¥ä¸‹æ•°æ®:

- `mockUsers.json` - ç”¨æˆ·æ•°æ®
- `mockRoles.json` - è§’è‰²æ•°æ®
- `mockPermissions.json` - æƒé™æ•°æ®
- `mockMenuPermissions.json` - èœå•æƒé™å…³è”
- `mockWorkflows.json` - å·¥ä½œæµæ•°æ®
- `mockWorkflowHistory.json` - å·¥ä½œæµå†å²
- `mockFormConfigs.json` - åŠ¨æ€è¡¨å•é…ç½®

## API ç«¯ç‚¹æ˜ å°„

| åŠŸèƒ½     | Mock æ•°æ®            | çœŸå® API             |
| -------- | -------------------- | -------------------- |
| ç”¨æˆ·ç®¡ç† | mockUsers.json       | GET /api/users       |
| è§’è‰²ç®¡ç† | mockRoles.json       | GET /api/roles       |
| æƒé™ç®¡ç† | mockPermissions.json | GET /api/permissions |
| å·¥ä½œæµ   | mockWorkflows.json   | GET /api/workflows   |
| è¡¨å•é…ç½® | mockFormConfigs.json | GET /api/forms       |

## æ•…éšœæ’é™¤

### é—®é¢˜ 1: åˆ‡æ¢åˆ° API åæ— æ•°æ®

**åŸå› **: åç«¯æœåŠ¡æœªå¯åŠ¨æˆ–ä»£ç†é…ç½®é”™è¯¯

**è§£å†³**:

```bash
# æ£€æŸ¥åç«¯æ˜¯å¦è¿è¡Œ
cd server
npm run start:dev

# æ£€æŸ¥ proxy.conf.json é…ç½®
# ç¡®ä¿ target æŒ‡å‘æ­£ç¡®çš„åç«¯åœ°å€
```

### é—®é¢˜ 2: Mock æ•°æ®æœªç”Ÿæ•ˆ

**åŸå› **: `useMockData` é…ç½®æœªæ­£ç¡®è®¾ç½®

**è§£å†³**:

1. æ£€æŸ¥ `environment.development.ts` ä¸­ `useMockData: true`
2. ç¡®ä¿ä½¿ç”¨å¼€å‘æ¨¡å¼å¯åŠ¨: `ng serve`
3. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜å¹¶åˆ·æ–°

### é—®é¢˜ 3: CORS é”™è¯¯

**åŸå› **: åç«¯æœªé…ç½® CORS æˆ–ä»£ç†é…ç½®é”™è¯¯

**è§£å†³**:

- ç¡®ä¿ `proxy.conf.json` ä¸­ `changeOrigin: true`
- åç«¯å·²é…ç½®å…è®¸ CORS (NestJS é»˜è®¤å·²é…ç½®)

### é—®é¢˜ 4: æ•°æ®æ ¼å¼ä¸åŒ¹é…

**åŸå› **: Mock æ•°æ®æ ¼å¼ä¸ API è¿”å›æ ¼å¼ä¸ä¸€è‡´

**è§£å†³**:

- æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯
- å¯¹æ¯” Mock æ•°æ®å’Œ API å“åº”æ ¼å¼
- æ›´æ–° Mock æ•°æ®ä½¿å…¶ä¸ API ä¿æŒä¸€è‡´

## æœ€ä½³å®è·µ

1. **å¼€å‘åˆæœŸ**: ä½¿ç”¨ Mock æ•°æ®å¿«é€Ÿæ„å»º UI
2. **åŠŸèƒ½å®Œæˆ**: åˆ‡æ¢åˆ°çœŸå® API è¿›è¡Œé›†æˆæµ‹è¯•
3. **Mock æ•°æ®ç»´æŠ¤**: å®šæœŸåŒæ­¥ Mock æ•°æ®ä¸ API æ ¼å¼
4. **æ–‡æ¡£è®°å½•**: æ›´æ–° Mock æ•°æ®æ—¶åŒæ­¥æ›´æ–°æ–‡æ¡£
5. **ç¯å¢ƒéš”ç¦»**: ä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒé…ç½®æ–‡ä»¶

## ç¤ºä¾‹ï¼šå®Œæ•´å·¥ä½œæµç¨‹

### é˜¶æ®µ 1: å‰ç«¯å¼€å‘ï¼ˆç¬¬ 1-2 å‘¨ï¼‰

```typescript
// environment.development.ts
useMockData: true;
```

- ä½¿ç”¨ Mock æ•°æ®
- å¿«é€Ÿè¿­ä»£ UI
- æ— éœ€ç­‰å¾…åç«¯

### é˜¶æ®µ 2: å‰åç«¯è”è°ƒï¼ˆç¬¬ 3 å‘¨ï¼‰

```typescript
// environment.development.ts
useMockData: false;
```

- å¯åŠ¨åç«¯æœåŠ¡
- éªŒè¯çœŸå®æ•°æ®
- ä¿®å¤é›†æˆé—®é¢˜

### é˜¶æ®µ 3: æµ‹è¯•ä¸ä¼˜åŒ–ï¼ˆç¬¬ 4 å‘¨ï¼‰

```typescript
// æ¥å›åˆ‡æ¢æµ‹è¯•
useMockData: true; // Mock æ•°æ®æµ‹è¯•
useMockData: false; // çœŸå® API æµ‹è¯•
```

### é˜¶æ®µ 4: ç”Ÿäº§éƒ¨ç½²

```typescript
// environment.ts (ç”Ÿäº§ç¯å¢ƒ)
useMockData: false; // æ°¸è¿œä½¿ç”¨çœŸå® API
```

## æ³¨æ„äº‹é¡¹

âš ï¸ **é‡è¦æç¤º**:

- ä¿®æ”¹ç¯å¢ƒé…ç½®åéœ€è¦é‡å¯ `ng serve`
- ç”Ÿäº§ç¯å¢ƒæ°¸è¿œä¸è¦ä½¿ç”¨ Mock æ•°æ®
- Mock æ•°æ®ä»…ç”¨äºå¼€å‘å’Œæ¼”ç¤º
- å®šæœŸåŒæ­¥ Mock æ•°æ®ä¸ API æ ¼å¼ä¿æŒä¸€è‡´
